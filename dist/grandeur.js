/*! For license information please see grandeur.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.grandeur=e():t.grandeur=e()}(this,(()=>(()=>{var t={560:function(){var t=t||this,e=e||void 0;!function(t){"use strict";var e="cuid",r=0,n=Math.pow(36,4),o=function(t,e){var r="000000000"+t;return r.substr(r.length-e)},i=function(){return o((Math.random()*n<<0).toString(36),4)},a=function(){var t,e=(new Date).getTime().toString(36),u=a.fingerprint(),c=i()+i();return t=o((r=r<n?r:0).toString(36),4),r++,"c"+e+t+u+c};a.globalCount=function(){var t=function(){var t,e=0;for(t in window)e++;return e}();return a.globalCount=function(){return t},t},a.fingerprint=function(){return o((navigator.mimeTypes.length+navigator.userAgent.length).toString(36)+a.globalCount().toString(36),4)},t.register?t.register(e,a):t[e=t.exports?"exports":e]=a}(t.applitude||e||this)},187:t=>{"use strict";var e,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};e=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function i(){i.init.call(this)}t.exports=i,t.exports.once=function(t,e){return new Promise((function(r,n){function o(r){t.removeListener(e,i),n(r)}function i(){"function"==typeof t.removeListener&&t.removeListener("error",o),r([].slice.call(arguments))}d(t,e,i,{once:!0}),"error"!==e&&function(t,e,r){"function"==typeof t.on&&d(t,"error",e,{once:!0})}(t,o)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function u(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function c(t){return void 0===t._maxListeners?i.defaultMaxListeners:t._maxListeners}function s(t,e,r,n){var o,i,a,s;if(u(r),void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),i=t._events),a=i[e]),void 0===a)a=i[e]=r,++t._eventsCount;else if("function"==typeof a?a=i[e]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),(o=c(t))>0&&a.length>o&&!a.warned){a.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=t,f.type=e,f.count=a.length,s=f,console&&console.warn&&console.warn(s)}return t}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},o=f.bind(n);return o.listener=r,n.wrapFn=o,o}function l(t,e,r){var n=t._events;if(void 0===n)return[];var o=n[e];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(o):v(o,o.length)}function p(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function v(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function d(t,e,r,n){if("function"==typeof t.on)n.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function o(i){n.once&&t.removeEventListener(e,o),r(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");a=t}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var o="error"===t,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var u=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw u.context=a,u}var c=i[t];if(void 0===c)return!1;if("function"==typeof c)n(c,this,e);else{var s=c.length,f=v(c,s);for(r=0;r<s;++r)n(f[r],this,e)}return!0},i.prototype.addListener=function(t,e){return s(this,t,e,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(t,e){return s(this,t,e,!0)},i.prototype.once=function(t,e){return u(e),this.on(t,h(this,t,e)),this},i.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,h(this,t,e)),this},i.prototype.removeListener=function(t,e){var r,n,o,i,a;if(u(e),void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===e||r[i].listener===e){a=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,o),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,a||e)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},i.prototype.listeners=function(t){return l(this,t,!0)},i.prototype.rawListeners=function(t){return l(this,t,!1)},i.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},i.prototype.listenerCount=p,i.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},90:(t,e,r)=>{var n;!function(){"use strict";var e="object"==typeof window?window:{};!e.HI_BASE32_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node&&(e=r.g);var o=!e.HI_BASE32_NO_COMMON_JS&&t.exports,i=r.amdO,a="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".split(""),u={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,2:26,3:27,4:28,5:29,6:30,7:31},c=[0,0,0,0,0,0,0,0],s=function(t,e){e.length>10&&(e="..."+e.substr(-10));var r=new Error("Decoded data is not valid UTF-8. Maybe try base32.decode.asBytes()? Partial data after reading "+t+" bytes: "+e+" <-");throw r.position=t,r},f=function(t){if(""===t)return[];if(!/^[A-Z2-7=]+$/.test(t))throw new Error("Invalid base32 characters");for(var e,r,n,o,i,a,c,s,f=[],h=0,l=(t=t.replace(/=/g,"")).length,p=0,v=l>>3<<3;p<v;)e=u[t.charAt(p++)],r=u[t.charAt(p++)],n=u[t.charAt(p++)],o=u[t.charAt(p++)],i=u[t.charAt(p++)],a=u[t.charAt(p++)],c=u[t.charAt(p++)],s=u[t.charAt(p++)],f[h++]=255&(e<<3|r>>>2),f[h++]=255&(r<<6|n<<1|o>>>4),f[h++]=255&(o<<4|i>>>1),f[h++]=255&(i<<7|a<<2|c>>>3),f[h++]=255&(c<<5|s);var d=l-v;return 2===d?(e=u[t.charAt(p++)],r=u[t.charAt(p++)],f[h++]=255&(e<<3|r>>>2)):4===d?(e=u[t.charAt(p++)],r=u[t.charAt(p++)],n=u[t.charAt(p++)],o=u[t.charAt(p++)],f[h++]=255&(e<<3|r>>>2),f[h++]=255&(r<<6|n<<1|o>>>4)):5===d?(e=u[t.charAt(p++)],r=u[t.charAt(p++)],n=u[t.charAt(p++)],o=u[t.charAt(p++)],i=u[t.charAt(p++)],f[h++]=255&(e<<3|r>>>2),f[h++]=255&(r<<6|n<<1|o>>>4),f[h++]=255&(o<<4|i>>>1)):7===d&&(e=u[t.charAt(p++)],r=u[t.charAt(p++)],n=u[t.charAt(p++)],o=u[t.charAt(p++)],i=u[t.charAt(p++)],a=u[t.charAt(p++)],c=u[t.charAt(p++)],f[h++]=255&(e<<3|r>>>2),f[h++]=255&(r<<6|n<<1|o>>>4),f[h++]=255&(o<<4|i>>>1),f[h++]=255&(i<<7|a<<2|c>>>3)),f},h=function(t,e){if(!e)return function(t){for(var e,r,n="",o=t.length,i=0,a=0;i<o;)if((e=t[i++])<=127)n+=String.fromCharCode(e);else{e>191&&e<=223?(r=31&e,a=1):e<=239?(r=15&e,a=2):e<=247?(r=7&e,a=3):s(i,n);for(var u=0;u<a;++u)((e=t[i++])<128||e>191)&&s(i,n),r<<=6,r+=63&e;r>=55296&&r<=57343&&s(i,n),r>1114111&&s(i,n),r<=65535?n+=String.fromCharCode(r):(r-=65536,n+=String.fromCharCode(55296+(r>>10)),n+=String.fromCharCode(56320+(1023&r)))}return n}(f(t));if(""===t)return"";if(!/^[A-Z2-7=]+$/.test(t))throw new Error("Invalid base32 characters");var r,n,o,i,a,c,h,l,p="",v=t.indexOf("=");-1===v&&(v=t.length);for(var d=0,y=v>>3<<3;d<y;)r=u[t.charAt(d++)],n=u[t.charAt(d++)],o=u[t.charAt(d++)],i=u[t.charAt(d++)],a=u[t.charAt(d++)],c=u[t.charAt(d++)],h=u[t.charAt(d++)],l=u[t.charAt(d++)],p+=String.fromCharCode(255&(r<<3|n>>>2))+String.fromCharCode(255&(n<<6|o<<1|i>>>4))+String.fromCharCode(255&(i<<4|a>>>1))+String.fromCharCode(255&(a<<7|c<<2|h>>>3))+String.fromCharCode(255&(h<<5|l));var w=v-y;return 2===w?(r=u[t.charAt(d++)],n=u[t.charAt(d++)],p+=String.fromCharCode(255&(r<<3|n>>>2))):4===w?(r=u[t.charAt(d++)],n=u[t.charAt(d++)],o=u[t.charAt(d++)],i=u[t.charAt(d++)],p+=String.fromCharCode(255&(r<<3|n>>>2))+String.fromCharCode(255&(n<<6|o<<1|i>>>4))):5===w?(r=u[t.charAt(d++)],n=u[t.charAt(d++)],o=u[t.charAt(d++)],i=u[t.charAt(d++)],a=u[t.charAt(d++)],p+=String.fromCharCode(255&(r<<3|n>>>2))+String.fromCharCode(255&(n<<6|o<<1|i>>>4))+String.fromCharCode(255&(i<<4|a>>>1))):7===w&&(r=u[t.charAt(d++)],n=u[t.charAt(d++)],o=u[t.charAt(d++)],i=u[t.charAt(d++)],a=u[t.charAt(d++)],c=u[t.charAt(d++)],h=u[t.charAt(d++)],p+=String.fromCharCode(255&(r<<3|n>>>2))+String.fromCharCode(255&(n<<6|o<<1|i>>>4))+String.fromCharCode(255&(i<<4|a>>>1))+String.fromCharCode(255&(a<<7|c<<2|h>>>3))),p},l={encode:function(t,e){var r="string"!=typeof t;return r&&t.constructor===ArrayBuffer&&(t=new Uint8Array(t)),r?function(t){for(var e,r,n,o,i,u="",c=t.length,s=0,f=5*parseInt(c/5);s<f;)e=t[s++],r=t[s++],n=t[s++],o=t[s++],i=t[s++],u+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[31&(r<<4|n>>>4)]+a[31&(n<<1|o>>>7)]+a[o>>>2&31]+a[31&(o<<3|i>>>5)]+a[31&i];var h=c-f;return 1===h?(e=t[s],u+=a[e>>>3]+a[e<<2&31]+"======"):2===h?(e=t[s++],r=t[s],u+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[r<<4&31]+"===="):3===h?(e=t[s++],r=t[s++],n=t[s],u+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[31&(r<<4|n>>>4)]+a[n<<1&31]+"==="):4===h&&(e=t[s++],r=t[s++],n=t[s++],o=t[s],u+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[31&(r<<4|n>>>4)]+a[31&(n<<1|o>>>7)]+a[o>>>2&31]+a[o<<3&31]+"="),u}(t):e?function(t){for(var e,r,n,o,i,u="",c=t.length,s=0,f=5*parseInt(c/5);s<f;)e=t.charCodeAt(s++),r=t.charCodeAt(s++),n=t.charCodeAt(s++),o=t.charCodeAt(s++),i=t.charCodeAt(s++),u+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[31&(r<<4|n>>>4)]+a[31&(n<<1|o>>>7)]+a[o>>>2&31]+a[31&(o<<3|i>>>5)]+a[31&i];var h=c-f;return 1===h?(e=t.charCodeAt(s),u+=a[e>>>3]+a[e<<2&31]+"======"):2===h?(e=t.charCodeAt(s++),r=t.charCodeAt(s),u+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[r<<4&31]+"===="):3===h?(e=t.charCodeAt(s++),r=t.charCodeAt(s++),n=t.charCodeAt(s),u+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[31&(r<<4|n>>>4)]+a[n<<1&31]+"==="):4===h&&(e=t.charCodeAt(s++),r=t.charCodeAt(s++),n=t.charCodeAt(s++),o=t.charCodeAt(s),u+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[31&(r<<4|n>>>4)]+a[31&(n<<1|o>>>7)]+a[o>>>2&31]+a[o<<3&31]+"="),u}(t):function(t){var e,r,n,o,i,u,s,f=!1,h="",l=0,p=0,v=t.length;if(""===t)return h;do{for(c[0]=c[5],c[1]=c[6],c[2]=c[7],s=p;l<v&&s<5;++l)(u=t.charCodeAt(l))<128?c[s++]=u:u<2048?(c[s++]=192|u>>6,c[s++]=128|63&u):u<55296||u>=57344?(c[s++]=224|u>>12,c[s++]=128|u>>6&63,c[s++]=128|63&u):(u=65536+((1023&u)<<10|1023&t.charCodeAt(++l)),c[s++]=240|u>>18,c[s++]=128|u>>12&63,c[s++]=128|u>>6&63,c[s++]=128|63&u);p=s-5,l===v&&++l,l>v&&s<6&&(f=!0),e=c[0],s>4?(r=c[1],n=c[2],o=c[3],i=c[4],h+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[31&(r<<4|n>>>4)]+a[31&(n<<1|o>>>7)]+a[o>>>2&31]+a[31&(o<<3|i>>>5)]+a[31&i]):1===s?h+=a[e>>>3]+a[e<<2&31]+"======":2===s?(r=c[1],h+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[r<<4&31]+"===="):3===s?(r=c[1],n=c[2],h+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[31&(r<<4|n>>>4)]+a[n<<1&31]+"==="):(r=c[1],n=c[2],o=c[3],h+=a[e>>>3]+a[31&(e<<2|r>>>6)]+a[r>>>1&31]+a[31&(r<<4|n>>>4)]+a[31&(n<<1|o>>>7)]+a[o>>>2&31]+a[o<<3&31]+"=")}while(!f);return h}(t)},decode:h};h.asBytes=f,o?t.exports=l:(e.base32=l,i&&(void 0===(n=function(){return l}.call(l,r,l,t))||(t.exports=n)))}()},53:function(t){t.exports=function(){"use strict";var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function e(t,e,r,n){var o,i,a,u=e||[0],c=(r=r||0)>>>3,s=-1===n?3:0;for(o=0;o<t.length;o+=1)i=(a=o+c)>>>2,u.length<=i&&u.push(0),u[i]|=t[o]<<8*(s+n*(a%4));return{value:u,binLen:8*t.length+r}}function r(r,n,o){switch(n){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(r){case"HEX":return function(t,e,r){return function(t,e,r,n){var o,i,a,u;if(0!=t.length%2)throw new Error("String of HEX type must be in byte increments");var c=e||[0],s=(r=r||0)>>>3,f=-1===n?3:0;for(o=0;o<t.length;o+=2){if(i=parseInt(t.substr(o,2),16),isNaN(i))throw new Error("String of HEX type contains invalid characters");for(a=(u=(o>>>1)+s)>>>2;c.length<=a;)c.push(0);c[a]|=i<<8*(f+n*(u%4))}return{value:c,binLen:4*t.length+r}}(t,e,r,o)};case"TEXT":return function(t,e,r){return function(t,e,r,n,o){var i,a,u,c,s,f,h,l,p=0,v=r||[0],d=(n=n||0)>>>3;if("UTF8"===e)for(h=-1===o?3:0,u=0;u<t.length;u+=1)for(a=[],128>(i=t.charCodeAt(u))?a.push(i):2048>i?(a.push(192|i>>>6),a.push(128|63&i)):55296>i||57344<=i?a.push(224|i>>>12,128|i>>>6&63,128|63&i):(u+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(u)),a.push(240|i>>>18,128|i>>>12&63,128|i>>>6&63,128|63&i)),c=0;c<a.length;c+=1){for(s=(f=p+d)>>>2;v.length<=s;)v.push(0);v[s]|=a[c]<<8*(h+o*(f%4)),p+=1}else for(h=-1===o?2:0,l="UTF16LE"===e&&1!==o||"UTF16LE"!==e&&1===o,u=0;u<t.length;u+=1){for(i=t.charCodeAt(u),!0===l&&(i=(c=255&i)<<8|i>>>8),s=(f=p+d)>>>2;v.length<=s;)v.push(0);v[s]|=i<<8*(h+o*(f%4)),p+=2}return{value:v,binLen:8*p+n}}(t,n,e,r,o)};case"B64":return function(e,r,n){return function(e,r,n,o){var i,a,u,c,s,f,h=0,l=r||[0],p=(n=n||0)>>>3,v=-1===o?3:0,d=e.indexOf("=");if(-1===e.search(/^[a-zA-Z0-9=+/]+$/))throw new Error("Invalid character in base-64 string");if(e=e.replace(/=/g,""),-1!==d&&d<e.length)throw new Error("Invalid '=' found in base-64 string");for(i=0;i<e.length;i+=4){for(c=e.substr(i,4),u=0,a=0;a<c.length;a+=1)u|=t.indexOf(c.charAt(a))<<18-6*a;for(a=0;a<c.length-1;a+=1){for(s=(f=h+p)>>>2;l.length<=s;)l.push(0);l[s]|=(u>>>16-8*a&255)<<8*(v+o*(f%4)),h+=1}}return{value:l,binLen:8*h+n}}(e,r,n,o)};case"BYTES":return function(t,e,r){return function(t,e,r,n){var o,i,a,u,c=e||[0],s=(r=r||0)>>>3,f=-1===n?3:0;for(i=0;i<t.length;i+=1)o=t.charCodeAt(i),a=(u=i+s)>>>2,c.length<=a&&c.push(0),c[a]|=o<<8*(f+n*(u%4));return{value:c,binLen:8*t.length+r}}(t,e,r,o)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error("ARRAYBUFFER not supported by this environment")}return function(t,r,n){return function(t,r,n,o){return e(new Uint8Array(t),r,n,o)}(t,r,n,o)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){throw new Error("UINT8ARRAY not supported by this environment")}return function(t,r,n){return e(t,r,n,o)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function n(e,r,n,o){switch(e){case"HEX":return function(t){return function(t,e,r,n){var o,i,a="",u=e/8,c=-1===r?3:0;for(o=0;o<u;o+=1)i=t[o>>>2]>>>8*(c+r*(o%4)),a+="0123456789abcdef".charAt(i>>>4&15)+"0123456789abcdef".charAt(15&i);return n.outputUpper?a.toUpperCase():a}(t,r,n,o)};case"B64":return function(e){return function(e,r,n,o){var i,a,u,c,s,f="",h=r/8,l=-1===n?3:0;for(i=0;i<h;i+=3)for(c=i+1<h?e[i+1>>>2]:0,s=i+2<h?e[i+2>>>2]:0,u=(e[i>>>2]>>>8*(l+n*(i%4))&255)<<16|(c>>>8*(l+n*((i+1)%4))&255)<<8|s>>>8*(l+n*((i+2)%4))&255,a=0;a<4;a+=1)f+=8*i+6*a<=r?t.charAt(u>>>6*(3-a)&63):o.b64Pad;return f}(e,r,n,o)};case"BYTES":return function(t){return function(t,e,r){var n,o,i="",a=e/8,u=-1===r?3:0;for(n=0;n<a;n+=1)o=t[n>>>2]>>>8*(u+r*(n%4))&255,i+=String.fromCharCode(o);return i}(t,r,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error("ARRAYBUFFER not supported by this environment")}return function(t){return function(t,e,r){var n,o=e/8,i=new ArrayBuffer(o),a=new Uint8Array(i),u=-1===r?3:0;for(n=0;n<o;n+=1)a[n]=t[n>>>2]>>>8*(u+r*(n%4))&255;return i}(t,r,n)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){throw new Error("UINT8ARRAY not supported by this environment")}return function(t){return function(t,e,r){var n,o=e/8,i=-1===r?3:0,a=new Uint8Array(o);for(n=0;n<o;n+=1)a[n]=t[n>>>2]>>>8*(i+r*(n%4))&255;return a}(t,r,n)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}var o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],i=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],a=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],u="Chosen SHA variant is not supported";function c(t,e){var r,n,o=t.binLen>>>3,i=e.binLen>>>3,a=o<<3,u=4-o<<3;if(o%4!=0){for(r=0;r<i;r+=4)n=o+r>>>2,t.value[n]|=e.value[r>>>2]<<a,t.value.push(0),t.value[n+1]|=e.value[r>>>2]>>>u;return(t.value.length<<2)-4>=i+o&&t.value.pop(),{value:t.value,binLen:t.binLen+e.binLen}}return{value:t.value.concat(e.value),binLen:t.binLen+e.binLen}}function s(t){var e={outputUpper:!1,b64Pad:"=",outputLen:-1},r=t||{},n="Output length must be a multiple of 8";if(e.outputUpper=r.outputUpper||!1,r.b64Pad&&(e.b64Pad=r.b64Pad),r.outputLen){if(r.outputLen%8!=0)throw new Error(n);e.outputLen=r.outputLen}else if(r.shakeLen){if(r.shakeLen%8!=0)throw new Error(n);e.outputLen=r.shakeLen}if("boolean"!=typeof e.outputUpper)throw new Error("Invalid outputUpper formatting option");if("string"!=typeof e.b64Pad)throw new Error("Invalid b64Pad formatting option");return e}function f(t,e,n,o){var i=t+" must include a value and format";if(!e){if(!o)throw new Error(i);return o}if(void 0===e.value||!e.format)throw new Error(i);return r(e.format,e.encoding||"UTF8",n)(e.value)}var h=function(){function t(t,e,r){var n=r||{};if(this.t=e,this.i=n.encoding||"UTF8",this.numRounds=n.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=t,this.u=[],this.s=0,this.h=!1,this.v=0,this.A=!1,this.l=[],this.H=[]}return t.prototype.update=function(t){var e,r=0,n=this.S>>>5,o=this.p(t,this.u,this.s),i=o.binLen,a=o.value,u=i>>>5;for(e=0;e<u;e+=n)r+this.S<=i&&(this.m=this.R(a.slice(e,e+n),this.m),r+=this.S);this.v+=r,this.u=a.slice(r>>>5),this.s=i%this.S,this.h=!0},t.prototype.getHash=function(t,e){var r,o,i=this.U,a=s(e);if(this.T){if(-1===a.outputLen)throw new Error("Output length must be specified in options");i=a.outputLen}var u=n(t,i,this.C,a);if(this.A&&this.F)return u(this.F(a));for(o=this.K(this.u.slice(),this.s,this.v,this.B(this.m),i),r=1;r<this.numRounds;r+=1)this.T&&i%32!=0&&(o[o.length-1]&=16777215>>>24-i%32),o=this.K(o,i,0,this.L(this.o),i);return u(o)},t.prototype.setHMACKey=function(t,e,n){if(!this.g)throw new Error("Variant does not support HMAC");if(this.h)throw new Error("Cannot set MAC key after calling update");var o=r(e,(n||{}).encoding||"UTF8",this.C);this.k(o(t))},t.prototype.k=function(t){var e,r=this.S>>>3,n=r/4-1;if(1!==this.numRounds)throw new Error("Cannot set numRounds with MAC");if(this.A)throw new Error("MAC key already set");for(r<t.binLen/8&&(t.value=this.K(t.value,t.binLen,0,this.L(this.o),this.U));t.value.length<=n;)t.value.push(0);for(e=0;e<=n;e+=1)this.l[e]=909522486^t.value[e],this.H[e]=1549556828^t.value[e];this.m=this.R(this.l,this.m),this.v=this.S,this.A=!0},t.prototype.getHMAC=function(t,e){var r=s(e);return n(t,this.U,this.C,r)(this.Y())},t.prototype.Y=function(){var t;if(!this.A)throw new Error("Cannot call getHMAC without first setting MAC key");var e=this.K(this.u.slice(),this.s,this.v,this.B(this.m),this.U);return t=this.R(this.H,this.L(this.o)),this.K(e,this.U,this.S,t,this.U)},t}(),l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function p(t,e){function r(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function v(t,e){return t<<e|t>>>32-e}function d(t,e){return t>>>e|t<<32-e}function y(t,e){return t>>>e}function w(t,e,r){return t^e^r}function m(t,e,r){return t&e^~t&r}function g(t,e,r){return t&e^t&r^e&r}function b(t){return d(t,2)^d(t,13)^d(t,22)}function E(t,e){var r=(65535&t)+(65535&e);return(65535&(t>>>16)+(e>>>16)+(r>>>16))<<16|65535&r}function S(t,e,r,n){var o=(65535&t)+(65535&e)+(65535&r)+(65535&n);return(65535&(t>>>16)+(e>>>16)+(r>>>16)+(n>>>16)+(o>>>16))<<16|65535&o}function A(t,e,r,n,o){var i=(65535&t)+(65535&e)+(65535&r)+(65535&n)+(65535&o);return(65535&(t>>>16)+(e>>>16)+(r>>>16)+(n>>>16)+(o>>>16)+(i>>>16))<<16|65535&i}function x(t){return d(t,7)^d(t,18)^y(t,3)}function N(t){return d(t,6)^d(t,11)^d(t,25)}function O(t){return[1732584193,4023233417,2562383102,271733878,3285377520]}function C(t,e){var r,n,o,i,a,u,c,s=[];for(r=e[0],n=e[1],o=e[2],i=e[3],a=e[4],c=0;c<80;c+=1)s[c]=c<16?t[c]:v(s[c-3]^s[c-8]^s[c-14]^s[c-16],1),u=c<20?A(v(r,5),m(n,o,i),a,1518500249,s[c]):c<40?A(v(r,5),w(n,o,i),a,1859775393,s[c]):c<60?A(v(r,5),g(n,o,i),a,2400959708,s[c]):A(v(r,5),w(n,o,i),a,3395469782,s[c]),a=i,i=o,o=v(n,30),n=r,r=u;return e[0]=E(r,e[0]),e[1]=E(n,e[1]),e[2]=E(o,e[2]),e[3]=E(i,e[3]),e[4]=E(a,e[4]),e}function L(t,e,r,n){for(var o,i=15+(e+65>>>9<<4),a=e+r;t.length<=i;)t.push(0);for(t[e>>>5]|=128<<24-e%32,t[i]=4294967295&a,t[i-1]=a/4294967296|0,o=0;o<t.length;o+=16)n=C(t.slice(o,o+16),n);return n}var I=function(t){function e(e,n,o){var i=this;if("SHA-1"!==e)throw new Error(u);var a=o||{};return(i=t.call(this,e,n,o)||this).g=!0,i.F=i.Y,i.C=-1,i.p=r(i.t,i.i,i.C),i.R=C,i.B=function(t){return t.slice()},i.L=O,i.K=L,i.m=[1732584193,4023233417,2562383102,271733878,3285377520],i.S=512,i.U=160,i.T=!1,a.hmacKey&&i.k(f("hmacKey",a.hmacKey,i.C)),i}return p(e,t),e}(h);function k(t){return"SHA-224"==t?i.slice():a.slice()}function j(t,e){var r,n,i,a,u,c,s,f,h,l,p,v,w=[];for(r=e[0],n=e[1],i=e[2],a=e[3],u=e[4],c=e[5],s=e[6],f=e[7],p=0;p<64;p+=1)w[p]=p<16?t[p]:S(d(v=w[p-2],17)^d(v,19)^y(v,10),w[p-7],x(w[p-15]),w[p-16]),h=A(f,N(u),m(u,c,s),o[p],w[p]),l=E(b(r),g(r,n,i)),f=s,s=c,c=u,u=E(a,h),a=i,i=n,n=r,r=E(h,l);return e[0]=E(r,e[0]),e[1]=E(n,e[1]),e[2]=E(i,e[2]),e[3]=E(a,e[3]),e[4]=E(u,e[4]),e[5]=E(c,e[5]),e[6]=E(s,e[6]),e[7]=E(f,e[7]),e}var P=function(t){function e(e,n,o){var i=this;if("SHA-224"!==e&&"SHA-256"!==e)throw new Error(u);var a=o||{};return(i=t.call(this,e,n,o)||this).F=i.Y,i.g=!0,i.C=-1,i.p=r(i.t,i.i,i.C),i.R=j,i.B=function(t){return t.slice()},i.L=k,i.K=function(t,r,n,o){return function(t,e,r,n,o){for(var i,a=15+(e+65>>>9<<4),u=e+r;t.length<=a;)t.push(0);for(t[e>>>5]|=128<<24-e%32,t[a]=4294967295&u,t[a-1]=u/4294967296|0,i=0;i<t.length;i+=16)n=j(t.slice(i,i+16),n);return"SHA-224"===o?[n[0],n[1],n[2],n[3],n[4],n[5],n[6]]:n}(t,r,n,o,e)},i.m=k(e),i.S=512,i.U="SHA-224"===e?224:256,i.T=!1,a.hmacKey&&i.k(f("hmacKey",a.hmacKey,i.C)),i}return p(e,t),e}(h),T=function(t,e){this.N=t,this.I=e};function _(t,e){var r;return e>32?(r=64-e,new T(t.I<<e|t.N>>>r,t.N<<e|t.I>>>r)):0!==e?(r=32-e,new T(t.N<<e|t.I>>>r,t.I<<e|t.N>>>r)):t}function D(t,e){var r;return e<32?(r=32-e,new T(t.N>>>e|t.I<<r,t.I>>>e|t.N<<r)):(r=64-e,new T(t.I>>>e|t.N<<r,t.N>>>e|t.I<<r))}function U(t,e){return new T(t.N>>>e,t.I>>>e|t.N<<32-e)}function R(t,e,r){return new T(t.N&e.N^~t.N&r.N,t.I&e.I^~t.I&r.I)}function H(t,e,r){return new T(t.N&e.N^t.N&r.N^e.N&r.N,t.I&e.I^t.I&r.I^e.I&r.I)}function F(t){var e=D(t,28),r=D(t,34),n=D(t,39);return new T(e.N^r.N^n.N,e.I^r.I^n.I)}function K(t,e){var r,n;r=(65535&t.I)+(65535&e.I);var o=(65535&(n=(t.I>>>16)+(e.I>>>16)+(r>>>16)))<<16|65535&r;return r=(65535&t.N)+(65535&e.N)+(n>>>16),n=(t.N>>>16)+(e.N>>>16)+(r>>>16),new T((65535&n)<<16|65535&r,o)}function M(t,e,r,n){var o,i;o=(65535&t.I)+(65535&e.I)+(65535&r.I)+(65535&n.I);var a=(65535&(i=(t.I>>>16)+(e.I>>>16)+(r.I>>>16)+(n.I>>>16)+(o>>>16)))<<16|65535&o;return o=(65535&t.N)+(65535&e.N)+(65535&r.N)+(65535&n.N)+(i>>>16),i=(t.N>>>16)+(e.N>>>16)+(r.N>>>16)+(n.N>>>16)+(o>>>16),new T((65535&i)<<16|65535&o,a)}function B(t,e,r,n,o){var i,a;i=(65535&t.I)+(65535&e.I)+(65535&r.I)+(65535&n.I)+(65535&o.I);var u=(65535&(a=(t.I>>>16)+(e.I>>>16)+(r.I>>>16)+(n.I>>>16)+(o.I>>>16)+(i>>>16)))<<16|65535&i;return i=(65535&t.N)+(65535&e.N)+(65535&r.N)+(65535&n.N)+(65535&o.N)+(a>>>16),a=(t.N>>>16)+(e.N>>>16)+(r.N>>>16)+(n.N>>>16)+(o.N>>>16)+(i>>>16),new T((65535&a)<<16|65535&i,u)}function G(t,e){return new T(t.N^e.N,t.I^e.I)}function Y(t){var e=D(t,1),r=D(t,8),n=U(t,7);return new T(e.N^r.N^n.N,e.I^r.I^n.I)}function X(t){var e=D(t,14),r=D(t,18),n=D(t,41);return new T(e.N^r.N^n.N,e.I^r.I^n.I)}var V=[new T(o[0],3609767458),new T(o[1],602891725),new T(o[2],3964484399),new T(o[3],2173295548),new T(o[4],4081628472),new T(o[5],3053834265),new T(o[6],2937671579),new T(o[7],3664609560),new T(o[8],2734883394),new T(o[9],1164996542),new T(o[10],1323610764),new T(o[11],3590304994),new T(o[12],4068182383),new T(o[13],991336113),new T(o[14],633803317),new T(o[15],3479774868),new T(o[16],2666613458),new T(o[17],944711139),new T(o[18],2341262773),new T(o[19],2007800933),new T(o[20],1495990901),new T(o[21],1856431235),new T(o[22],3175218132),new T(o[23],2198950837),new T(o[24],3999719339),new T(o[25],766784016),new T(o[26],2566594879),new T(o[27],3203337956),new T(o[28],1034457026),new T(o[29],2466948901),new T(o[30],3758326383),new T(o[31],168717936),new T(o[32],1188179964),new T(o[33],1546045734),new T(o[34],1522805485),new T(o[35],2643833823),new T(o[36],2343527390),new T(o[37],1014477480),new T(o[38],1206759142),new T(o[39],344077627),new T(o[40],1290863460),new T(o[41],3158454273),new T(o[42],3505952657),new T(o[43],106217008),new T(o[44],3606008344),new T(o[45],1432725776),new T(o[46],1467031594),new T(o[47],851169720),new T(o[48],3100823752),new T(o[49],1363258195),new T(o[50],3750685593),new T(o[51],3785050280),new T(o[52],3318307427),new T(o[53],3812723403),new T(o[54],2003034995),new T(o[55],3602036899),new T(o[56],1575990012),new T(o[57],1125592928),new T(o[58],2716904306),new T(o[59],442776044),new T(o[60],593698344),new T(o[61],3733110249),new T(o[62],2999351573),new T(o[63],3815920427),new T(3391569614,3928383900),new T(3515267271,566280711),new T(3940187606,3454069534),new T(4118630271,4000239992),new T(116418474,1914138554),new T(174292421,2731055270),new T(289380356,3203993006),new T(460393269,320620315),new T(685471733,587496836),new T(852142971,1086792851),new T(1017036298,365543100),new T(1126000580,2618297676),new T(1288033470,3409855158),new T(1501505948,4234509866),new T(1607167915,987167468),new T(1816402316,1246189591)];function J(t){return"SHA-384"===t?[new T(3418070365,i[0]),new T(1654270250,i[1]),new T(2438529370,i[2]),new T(355462360,i[3]),new T(1731405415,i[4]),new T(41048885895,i[5]),new T(3675008525,i[6]),new T(1203062813,i[7])]:[new T(a[0],4089235720),new T(a[1],2227873595),new T(a[2],4271175723),new T(a[3],1595750129),new T(a[4],2917565137),new T(a[5],725511199),new T(a[6],4215389547),new T(a[7],327033209)]}function q(t,e){var r,n,o,i,a,u,c,s,f,h,l,p,v,d,y,w,m=[];for(r=e[0],n=e[1],o=e[2],i=e[3],a=e[4],u=e[5],c=e[6],s=e[7],l=0;l<80;l+=1)l<16?(p=2*l,m[l]=new T(t[p],t[p+1])):m[l]=M((void 0,void 0,void 0,d=D(v=m[l-2],19),y=D(v,61),w=U(v,6),new T(d.N^y.N^w.N,d.I^y.I^w.I)),m[l-7],Y(m[l-15]),m[l-16]),f=B(s,X(a),R(a,u,c),V[l],m[l]),h=K(F(r),H(r,n,o)),s=c,c=u,u=a,a=K(i,f),i=o,o=n,n=r,r=K(f,h);return e[0]=K(r,e[0]),e[1]=K(n,e[1]),e[2]=K(o,e[2]),e[3]=K(i,e[3]),e[4]=K(a,e[4]),e[5]=K(u,e[5]),e[6]=K(c,e[6]),e[7]=K(s,e[7]),e}var z=function(t){function e(e,n,o){var i=this;if("SHA-384"!==e&&"SHA-512"!==e)throw new Error(u);var a=o||{};return(i=t.call(this,e,n,o)||this).F=i.Y,i.g=!0,i.C=-1,i.p=r(i.t,i.i,i.C),i.R=q,i.B=function(t){return t.slice()},i.L=J,i.K=function(t,r,n,o){return function(t,e,r,n,o){for(var i,a=31+(e+129>>>10<<5),u=e+r;t.length<=a;)t.push(0);for(t[e>>>5]|=128<<24-e%32,t[a]=4294967295&u,t[a-1]=u/4294967296|0,i=0;i<t.length;i+=32)n=q(t.slice(i,i+32),n);return"SHA-384"===o?[n[0].N,n[0].I,n[1].N,n[1].I,n[2].N,n[2].I,n[3].N,n[3].I,n[4].N,n[4].I,n[5].N,n[5].I]:[n[0].N,n[0].I,n[1].N,n[1].I,n[2].N,n[2].I,n[3].N,n[3].I,n[4].N,n[4].I,n[5].N,n[5].I,n[6].N,n[6].I,n[7].N,n[7].I]}(t,r,n,o,e)},i.m=J(e),i.S=1024,i.U="SHA-384"===e?384:512,i.T=!1,a.hmacKey&&i.k(f("hmacKey",a.hmacKey,i.C)),i}return p(e,t),e}(h),Z=[new T(0,1),new T(0,32898),new T(2147483648,32906),new T(2147483648,2147516416),new T(0,32907),new T(0,2147483649),new T(2147483648,2147516545),new T(2147483648,32777),new T(0,138),new T(0,136),new T(0,2147516425),new T(0,2147483658),new T(0,2147516555),new T(2147483648,139),new T(2147483648,32905),new T(2147483648,32771),new T(2147483648,32770),new T(2147483648,128),new T(0,32778),new T(2147483648,2147483658),new T(2147483648,2147516545),new T(2147483648,32896),new T(0,2147483649),new T(2147483648,2147516424)],W=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function Q(t){var e,r=[];for(e=0;e<5;e+=1)r[e]=[new T(0,0),new T(0,0),new T(0,0),new T(0,0),new T(0,0)];return r}function $(t){var e,r=[];for(e=0;e<5;e+=1)r[e]=t[e].slice();return r}function tt(t,e){var r,n,o,i,a,u,c,s,f,h=[],l=[];if(null!==t)for(n=0;n<t.length;n+=2)e[(n>>>1)%5][(n>>>1)/5|0]=G(e[(n>>>1)%5][(n>>>1)/5|0],new T(t[n+1],t[n]));for(r=0;r<24;r+=1){for(i=Q(),n=0;n<5;n+=1)h[n]=(a=e[n][0],u=e[n][1],c=e[n][2],s=e[n][3],f=e[n][4],new T(a.N^u.N^c.N^s.N^f.N,a.I^u.I^c.I^s.I^f.I));for(n=0;n<5;n+=1)l[n]=G(h[(n+4)%5],_(h[(n+1)%5],1));for(n=0;n<5;n+=1)for(o=0;o<5;o+=1)e[n][o]=G(e[n][o],l[n]);for(n=0;n<5;n+=1)for(o=0;o<5;o+=1)i[o][(2*n+3*o)%5]=_(e[n][o],W[n][o]);for(n=0;n<5;n+=1)for(o=0;o<5;o+=1)e[n][o]=G(i[n][o],new T(~i[(n+1)%5][o].N&i[(n+2)%5][o].N,~i[(n+1)%5][o].I&i[(n+2)%5][o].I));e[0][0]=G(e[0][0],Z[r])}return e}function et(t){var e,r,n=0,o=[0,0],i=[4294967295&t,t/4294967296&2097151];for(e=6;e>=0;e--)0==(r=i[e>>2]>>>8*e&255)&&0===n||(o[n+1>>2]|=r<<8*(n+1),n+=1);return n=0!==n?n:1,o[0]|=n,{value:n+1>4?o:[o[0]],binLen:8+8*n}}function rt(t){return c(et(t.binLen),t)}function nt(t,e){var r,n=et(e),o=e>>>2,i=(o-(n=c(n,t)).value.length%o)%o;for(r=0;r<i;r++)n.value.push(0);return n.value}var ot=function(t){function e(e,n,o){var i=this,a=6,c=0,s=o||{};if(1!==(i=t.call(this,e,n,o)||this).numRounds){if(s.kmacKey||s.hmacKey)throw new Error("Cannot set numRounds with MAC");if("CSHAKE128"===i.o||"CSHAKE256"===i.o)throw new Error("Cannot set numRounds for CSHAKE variants")}switch(i.C=1,i.p=r(i.t,i.i,i.C),i.R=tt,i.B=$,i.L=Q,i.m=Q(),i.T=!1,e){case"SHA3-224":i.S=c=1152,i.U=224,i.g=!0,i.F=i.Y;break;case"SHA3-256":i.S=c=1088,i.U=256,i.g=!0,i.F=i.Y;break;case"SHA3-384":i.S=c=832,i.U=384,i.g=!0,i.F=i.Y;break;case"SHA3-512":i.S=c=576,i.U=512,i.g=!0,i.F=i.Y;break;case"SHAKE128":a=31,i.S=c=1344,i.U=-1,i.T=!0,i.g=!1,i.F=null;break;case"SHAKE256":a=31,i.S=c=1088,i.U=-1,i.T=!0,i.g=!1,i.F=null;break;case"KMAC128":a=4,i.S=c=1344,i.M(o),i.U=-1,i.T=!0,i.g=!1,i.F=i.X;break;case"KMAC256":a=4,i.S=c=1088,i.M(o),i.U=-1,i.T=!0,i.g=!1,i.F=i.X;break;case"CSHAKE128":i.S=c=1344,a=i.O(o),i.U=-1,i.T=!0,i.g=!1,i.F=null;break;case"CSHAKE256":i.S=c=1088,a=i.O(o),i.U=-1,i.T=!0,i.g=!1,i.F=null;break;default:throw new Error(u)}return i.K=function(t,e,r,n,o){return function(t,e,r,n,o,i,a){var u,c,s=0,f=[],h=o>>>5,l=e>>>5;for(u=0;u<l&&e>=o;u+=h)n=tt(t.slice(u,u+h),n),e-=o;for(t=t.slice(u),e%=o;t.length<h;)t.push(0);for(t[(u=e>>>3)>>2]^=i<<u%4*8,t[h-1]^=2147483648,n=tt(t,n);32*f.length<a&&(c=n[s%5][s/5|0],f.push(c.I),!(32*f.length>=a));)f.push(c.N),0==64*(s+=1)%o&&(tt(null,n),s=0);return f}(t,e,0,n,c,a,o)},s.hmacKey&&i.k(f("hmacKey",s.hmacKey,i.C)),i}return p(e,t),e.prototype.O=function(t,e){var r=function(t){var e=t||{};return{funcName:f("funcName",e.funcName,1,{value:[],binLen:0}),customization:f("Customization",e.customization,1,{value:[],binLen:0})}}(t||{});e&&(r.funcName=e);var n=c(rt(r.funcName),rt(r.customization));if(0!==r.customization.binLen||0!==r.funcName.binLen){for(var o=nt(n,this.S>>>3),i=0;i<o.length;i+=this.S>>>5)this.m=this.R(o.slice(i,i+(this.S>>>5)),this.m),this.v+=this.S;return 4}return 31},e.prototype.M=function(t){var e=function(t){var e=t||{};return{kmacKey:f("kmacKey",e.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:f("Customization",e.customization,1,{value:[],binLen:0})}}(t||{});this.O(t,e.funcName);for(var r=nt(rt(e.kmacKey),this.S>>>3),n=0;n<r.length;n+=this.S>>>5)this.m=this.R(r.slice(n,n+(this.S>>>5)),this.m),this.v+=this.S;this.A=!0},e.prototype.X=function(t){var e=c({value:this.u.slice(),binLen:this.s},function(t){var e,r,n=0,o=[0,0],i=[4294967295&t,t/4294967296&2097151];for(e=6;e>=0;e--)0==(r=i[e>>2]>>>8*e&255)&&0===n||(o[n>>2]|=r<<8*n,n+=1);return o[(n=0!==n?n:1)>>2]|=n<<8*n,{value:n+1>4?o:[o[0]],binLen:8+8*n}}(t.outputLen));return this.K(e.value,e.binLen,this.v,this.B(this.m),t.outputLen)},e}(h);return function(){function t(t,e,r){if("SHA-1"==t)this.j=new I(t,e,r);else if("SHA-224"==t||"SHA-256"==t)this.j=new P(t,e,r);else if("SHA-384"==t||"SHA-512"==t)this.j=new z(t,e,r);else{if("SHA3-224"!=t&&"SHA3-256"!=t&&"SHA3-384"!=t&&"SHA3-512"!=t&&"SHAKE128"!=t&&"SHAKE256"!=t&&"CSHAKE128"!=t&&"CSHAKE256"!=t&&"KMAC128"!=t&&"KMAC256"!=t)throw new Error(u);this.j=new ot(t,e,r)}}return t.prototype.update=function(t){this.j.update(t)},t.prototype.getHash=function(t,e){return this.j.getHash(t,e)},t.prototype.setHMACKey=function(t,e,r){this.j.setHMACKey(t,e,r)},t.prototype.getHMAC=function(t,e){return this.j.getHMAC(t,e)},t}()}()},833:(t,e,r)=>{"use strict";let n=r(53);function o(t){return parseInt(t,16)}function i(t,e,r){return e+1>=t.length&&(t=Array(e+1-t.length).join(r)+t),t}n.default&&(n=n.default),t.exports=function(t,e){let r,a,u,c,s,f;var h;return(e=e||{}).period=e.period||30,e.algorithm=e.algorithm||"SHA-1",e.digits=e.digits||6,e.timestamp=e.timestamp||Date.now(),t=function(t){let e="",r="";t=t.replace(/=+$/,"");for(let r=0;r<t.length;r++){let n="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".indexOf(t.charAt(r).toUpperCase());if(-1===n)throw new Error("Invalid base32 character in key");e+=i(n.toString(2),5,"0")}for(let t=0;t+8<=e.length;t+=8){let n=e.substr(t,8);r+=i(parseInt(n,2).toString(16),2,"0")}return r}(t),r=Math.round(e.timestamp/1e3),a=i(((h=Math.floor(r/e.period))<15.5?"0":"")+Math.round(h).toString(16),16,"0"),u=new n(e.algorithm,"HEX"),u.setHMACKey(t,"HEX"),u.update(a),c=u.getHMAC("HEX"),s=o(c.substring(c.length-1)),f=(o(c.substr(2*s,8))&o("7fffffff"))+"",f=f.substr(Math.max(f.length-e.digits,0),e.digits),f}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}r.amdO={},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){e=function(){return r};var r={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),u=new C(n||[]);return i(a,"_invoke",{value:A(t,r,u)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=h;var p={};function v(){}function d(){}function y(){}var w={};f(w,u,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(L([])));g&&g!==n&&o.call(g,u)&&(w=g);var b=y.prototype=v.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(e,r){function n(i,a,u,c){var s=l(e[i],e,a);if("throw"!==s.type){var f=s.arg,h=f.value;return h&&"object"==t(h)&&o.call(h,"__await")?r.resolve(h.__await).then((function(t){n("next",t,u,c)}),(function(t){n("throw",t,u,c)})):r.resolve(h).then((function(t){f.value=t,u(f)}),(function(t){return n("throw",t,u,c)}))}c(s.arg)}var a;i(this,"_invoke",{value:function(t,e){function o(){return new r((function(r,o){n(t,e,r,o)}))}return a=a?a.then(o,o):o()}})}function A(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=x(a,r);if(u){if(u===p)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function x(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function L(t){if(t){var e=t[u];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:I}}function I(){return{value:void 0,done:!0}}return d.prototype=y,i(b,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:d,configurable:!0}),d.displayName=f(y,s,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,f(t,s,"GeneratorFunction")),t.prototype=Object.create(b),t},r.awrap=function(t){return{__await:t}},E(S.prototype),f(S.prototype,c,(function(){return this})),r.AsyncIterator=S,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new S(h(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(b),f(b,s,"Generator"),f(b,u,(function(){return this})),f(b,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=L,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=o.call(i,"catchLoc"),c=o.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:L(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},r}function o(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function u(t){o(a,n,i,u,c,"next",t)}function c(t){o(a,n,i,u,c,"throw",t)}u(void 0)}))}}function a(e,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,r){if("object"!==t(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,r);if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key,"string"),"symbol"===t(i)?i:String(i)),o)}var i}r.r(n),r.d(n,{extend:()=>nt,init:()=>rt});const u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handlers=e,this.post=e.post,this.duplex=e.duplex}var r,n,o,u,c,s,f,h;return r=t,n=[{key:"login",value:(h=i(e().mark((function t(r,n){var o;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.post.send("/auth/login",{email:r,password:n});case 2:return"AUTH-ACCOUNT-LOGGEDIN"===(o=t.sent).code&&localStorage.setItem("grandeur-auth-".concat(this.post.config.apiKey),o.token),t.abrupt("return",o);case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return h.apply(this,arguments)})},{key:"register",value:(f=i(e().mark((function t(r,n,o,a){var u,c=this;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.post.send("/auth/register",{email:r,password:n,displayName:o,phone:a});case 3:if("PHONE-CODE-SENT"!==(u=t.sent).code){t.next=8;break}return t.abrupt("return",{code:u.code,message:u.message,confirm:function(){var t=i(e().mark((function t(r){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.post.send("/auth/register",{token:u.token,verificationCode:r});case 2:return"AUTH-ACCOUNT-REGISTERED"===(n=t.sent).code&&localStorage.setItem("grandeur-auth-".concat(c.post.config.apiKey),n.token),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()});case 8:return t.abrupt("return",u);case 9:t.next=14;break;case 11:throw t.prev=11,t.t0=t.catch(0),t.t0;case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t,e,r,n){return f.apply(this,arguments)})},{key:"updateProfile",value:(s=i(e().mark((function t(r,n,o){var i,a=this;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.post.send("/auth/updateProfile",{displayName:r,phone:o,displayPicture:n});case 3:if("PHONE-CODE-SENT"!==(i=t.sent).code){t.next=8;break}return t.abrupt("return",{code:i.code,message:i.message,confirm:function(t){return a.post.send("/auth/updateProfile",{token:i.token,verificationCode:t})}});case 8:return t.abrupt("return",i);case 9:t.next=14;break;case 11:throw t.prev=11,t.t0=t.catch(0),t.t0;case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t,e,r){return s.apply(this,arguments)})},{key:"forgotPassword",value:(c=i(e().mark((function t(r){var n,o=this;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.post.send("/auth/forgotPassword",{email:r});case 3:if("PHONE-CODE-SENT"!==(n=t.sent).code){t.next=8;break}return t.abrupt("return",{code:n.code,message:n.message,confirm:function(t,e){return o.post.send("/auth/forgotPassword",{token:n.token,verificationCode:t,password:e})}});case 8:return t.abrupt("return",n);case 9:t.next=14;break;case 11:throw t.prev=11,t.t0=t.catch(0),t.t0;case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return c.apply(this,arguments)})},{key:"changePassword",value:(u=i(e().mark((function t(r){var n,o=this;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.post.send("/auth/changePassword",{password:r});case 3:if("PHONE-CODE-SENT"!==(n=t.sent).code){t.next=8;break}return t.abrupt("return",{code:n.code,message:n.message,confirm:function(t){return o.post.send("/auth/changePassword",{token:n.token,verificationCode:t})}});case 8:return t.abrupt("return",n);case 9:t.next=14;break;case 11:throw t.prev=11,t.t0=t.catch(0),t.t0;case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return u.apply(this,arguments)})},{key:"isAuthenticated",value:function(){return this.post.send("/auth/protectedpage",{})}},{key:"ping",value:function(){return this.post.send("/auth/ping",{})}},{key:"logout",value:function(){return this.post.send("/auth/logout",{})}},{key:"token",value:(o=i(e().mark((function r(n){var o;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.post.send("/auth/ping",{},n);case 3:if("AUTH-AUTHORIZED"!==(o=e.sent).code){e.next=10;break}return localStorage.setItem("grandeur-auth-".concat(this.post.config.apiKey),n),this.duplex.disconnect(new t(this.handlers)),e.abrupt("return",o);case 10:throw{code:"TOKEN-INVALID"};case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(0),e.t0;case 16:case"end":return e.stop()}}),r,this,[[0,13]])}))),function(t){return o.apply(this,arguments)})}],n&&a(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==c(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key,"string"),"symbol"===c(o)?o:String(o)),n)}var o}function h(t,e,r){return e&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var l=function(){function t(e,r){s(this,t),this.post=e.post,this.duplex=e.duplex,this.deviceID=r}return h(t,[{key:"get",value:function(t){var e={deviceID:this.deviceID,path:t};return this.duplex.send("/device/data/get",e)}},{key:"set",value:function(t,e){var r={deviceID:this.deviceID,path:t,data:e};return this.duplex.send("/device/data/set",r)}},{key:"on",value:function(t,e){var r={event:"data",path:t,deviceID:this.deviceID};return this.duplex.subscribe("data",r,e)}}]),t}(),p=function(){function t(e,r){s(this,t),this.post=e.post,this.duplex=e.duplex,this.deviceID=r}return h(t,[{key:"pair",value:function(){var t={deviceID:this.deviceID};return this.duplex.send("/device/pair",t)}},{key:"unpair",value:function(){var t={deviceID:this.deviceID};return this.duplex.send("/device/unpair",t)}},{key:"get",value:function(t){var e={deviceID:this.deviceID,path:t};return this.duplex.send("/device/get",e)}},{key:"set",value:function(t,e){var r={deviceID:this.deviceID,path:t,data:e};return this.duplex.send("/device/set",r)}},{key:"on",value:function(t,e){var r={event:t,deviceID:this.deviceID};return this.duplex.subscribe(t,r,e)}},{key:"data",value:function(){return new l({post:this.post,duplex:this.duplex},this.deviceID)}}]),t}();const v=function(){function t(e){s(this,t),this.post=e.post,this.duplex=e.duplex}return h(t,[{key:"get",value:function(t){var e={filter:t};return this.duplex.send("/devices/get",e)}},{key:"count",value:function(t){var e={filter:t};return this.duplex.send("/devices/count",e)}},{key:"on",value:function(t){return this.duplex.subscribe("devices",{event:"devices"},t)}},{key:"device",value:function(t){return new p({post:this.post,duplex:this.duplex},t)}}]),t}();function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==d(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key,"string"),"symbol"===d(o)?o:String(o)),n)}var o}function m(t,e,r){return e&&w(t.prototype,e),r&&w(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var g=function(){function t(e,r,n,o){y(this,t),this.post=e.post,this.duplex=e.duplex,this.collection=r,this.index=n,this.query=o}return m(t,[{key:"match",value:function(e){return this.query.push({type:"match",filter:e}),new t({post:this.post,duplex:this.duplex},this.collection,this.index,this.query)}},{key:"project",value:function(e){return this.query.push({type:"project",specs:e}),new t({post:this.post,duplex:this.duplex},this.collection,this.index,this.query)}},{key:"group",value:function(e,r){return this.query.push({type:"group",condition:e,fields:r}),new t({post:this.post,duplex:this.duplex},this.collection,this.index,this.query)}},{key:"sort",value:function(e){return this.query.push({type:"sort",specs:e}),new t({post:this.post,duplex:this.duplex},this.collection,this.index,this.query)}},{key:"execute",value:function(t){var e={collection:this.collection,index:this.index,pipeline:this.query,nPage:t};return this.duplex.send("/datastore/pipeline",e)}}]),t}(),b=function(){function t(e,r){y(this,t),this.post=e.post,this.duplex=e.duplex,this.collection=r}return m(t,[{key:"insert",value:function(t){var e={collection:this.collection,documents:t};return this.duplex.send("/datastore/insert",e)}},{key:"delete",value:function(t){var e={collection:this.collection,filter:t};return this.duplex.send("/datastore/delete",e)}},{key:"update",value:function(t,e){var r={collection:this.collection,filter:t,update:e};return this.duplex.send("/datastore/update",r)}},{key:"search",value:function(t,e,r){var n=new g({post:this.post,duplex:this.duplex},this.collection,{},[]).match(t);return e&&(n=n.project(e)),n.execute(r)}},{key:"pipeline",value:function(t){return new g({post:this.post,duplex:this.duplex},this.collection,t,[])}}]),t}();const E=function(){function t(e){y(this,t),this.post=e.post,this.duplex=e.duplex}return m(t,[{key:"collection",value:function(t){return new b({post:this.post,duplex:this.duplex},t)}},{key:"list",value:function(t){var e={nPage:t};return this.duplex.send("/datastore/list",e)}},{key:"drop",value:function(t){var e={collection:t};return this.duplex.send("/datastore/drop",e)}}]),t}();var S=r(833),A=r.n(S),x=r(90);function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function O(){O=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function s(t,e,r,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype),u=new C(o||[]);return n(a,"_invoke",{value:E(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var h={};function l(){}function p(){}function v(){}var d={};c(d,i,(function(){return this}));var y=Object.getPrototypeOf,w=y&&y(y(L([])));w&&w!==e&&r.call(w,i)&&(d=w);var m=v.prototype=l.prototype=Object.create(d);function g(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,i,a,u){var c=f(t[n],t,i);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"==N(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=S(a,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=f(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function S(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=f(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function L(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return p.prototype=v,n(m,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:p,configurable:!0}),p.displayName=c(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},g(b.prototype),c(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=L,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:L(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function C(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==N(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key,"string"),"symbol"===N(o)?o:String(o)),n)}var o}var I=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,this.status="ACTIVE"}var e,r;return e=t,r=[{key:"dispose",value:function(){this.status="DISPOSED"}},{key:"send",value:function(t,e,r){var n=this;return new Promise(function(){var o,i=(o=O().mark((function o(i,a){var u,c,s,f,h;return O().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if("DISPOSED"!==n.status){o.next=2;break}return o.abrupt("return",a({code:"DISPOSED"}));case 2:return u="".concat(n.config.url).concat(t||"/","?apiKey=").concat(n.config.apiKey),c="","undefined"!=typeof window&&(c=r||localStorage.getItem("grandeur-auth-".concat(n.config.apiKey))||""),s={authorization:c},f=JSON.stringify(e),s["content-type"]="application/json",s["gt-otp"]=A()((0,x.encode)(n.config.secretKey)),o.prev=9,o.next=12,fetch(u,{method:"POST",mode:"cors",body:f,credentials:"include",SameSite:"none",headers:s});case 12:return h=o.sent,o.next=15,h.json();case 15:h=o.sent,i(h),o.next=22;break;case 19:o.prev=19,o.t0=o.catch(9),a({code:"CONNECTION-REFUSED"});case 22:case 23:case"end":return o.stop()}}),o,null,[[9,19]])})),function(){var t=this,e=arguments;return new Promise((function(r,n){var i=o.apply(t,e);function a(t){C(i,r,n,a,u,"next",t)}function u(t){C(i,r,n,a,u,"throw",t)}a(void 0)}))});return function(t,e){return i.apply(this,arguments)}}())}}],r&&L(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();const k=I;var j=r(187),P=r(560);function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function _(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function D(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_(Object(r),!0).forEach((function(e){U(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function U(t,e,r){return(e=B(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R(){R=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function s(t,e,r,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype),u=new N(o||[]);return n(a,"_invoke",{value:E(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var h={};function l(){}function p(){}function v(){}var d={};c(d,i,(function(){return this}));var y=Object.getPrototypeOf,w=y&&y(y(O([])));w&&w!==e&&r.call(w,i)&&(d=w);var m=v.prototype=l.prototype=Object.create(d);function g(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,i,a,u){var c=f(t[n],t,i);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"==T(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=S(a,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=f(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function S(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=f(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function O(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:C}}function C(){return{value:void 0,done:!0}}return p.prototype=v,n(m,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:p,configurable:!0}),p.displayName=c(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},g(b.prototype),c(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=O,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function H(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function F(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B(n.key),n)}}function M(t,e,r){return e&&K(t.prototype,e),r&&K(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function B(t){var e=function(t,e){if("object"!==T(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===T(e)?e:String(e)}function G(t,e){return G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},G(t,e)}function Y(t,e){if(e&&("object"===T(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function X(t){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},X(t)}var V=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&G(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=X(e);if(r){var o=X(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Y(this,t)});function o(){return F(this,o),n.apply(this,arguments)}return M(o,[{key:"pEmit",value:function(t){for(var e=this,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this.eventNames().forEach((function(r){t.match(new RegExp(r))&&e.emit.apply(e,[r].concat(n))}))}}]),o}(j.EventEmitter),J=function(){function t(){F(this,t),this.list={}}return M(t,[{key:"push",value:function(t,e){this.list[t]=e}},{key:"forEach",value:function(t){var e=this;Object.keys(this.list).forEach((function(r){return t(e.list[r])}))}},{key:"remove",value:function(t){delete this.list[t]}}]),t}(),q=function(){function t(e){F(this,t),this.config=e,this.tasks=new V,this.subscriptions=new V,this.status="CONNECTING",this.cConnection=null,this.buffer=new J,this.topics={user:["devices"],device:["name","status","data"]}}var e,r;return M(t,[{key:"init",value:(e=R().mark((function t(e){var r,n,o,i=this;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.ping();case 3:r=t.sent,t.t0=r.code,t.next="AUTH-AUTHORIZED"===t.t0?7:"AUTH-UNAUTHORIZED"===t.t0?12:"SIGNATURE-INVALID"===t.t0||"TOTP-INVALID"===t.t0?16:19;break;case 7:return n="","undefined"!=typeof window&&(n=localStorage.getItem("grandeur-auth-".concat(this.config.apiKey))||""),o="".concat(this.config.node,"?apiKey=").concat(this.config.apiKey,"&token=").concat(n),this.ws=new WebSocket(o,"node"),t.abrupt("break",19);case 12:return this.reconnect(e),this.setStatus("AUTH-UNAUTHORIZED"),this.flush(),t.abrupt("return");case 16:return this.setStatus("SIGNATURE-INVALID"),this.flush(),t.abrupt("return");case 19:t.next=27;break;case 21:return t.prev=21,t.t1=t.catch(0),this.reconnect(e),this.setStatus("CONNECTION-REFUSED"),this.flush(),t.abrupt("return");case 27:this.ws.onopen=function(){i.setStatus("CONNECTED"),i.cConnection&&i.cConnection("CONNECTED"),i.ping=setInterval((function(){i.ws.send(JSON.stringify({header:{id:"ping",task:"ping"},payload:{}}))}),25e3),i.handle()},this.ws.onclose=function(){i.setStatus("CONNECTING"),i.cConnection&&i.cConnection("DISCONNECTED"),clearInterval(i.ping),i.reconnect(e)},this.ws.onmessage=function(t){var e=JSON.parse(t.data);if("update"===e.header.task)if("deviceParms"!==e.payload.event&&"deviceSummary"!==e.payload.event||(e.payload.event="data"),i.topics.device.includes(e.payload.event)){var r="".concat(e.payload.deviceID,"/").concat(e.payload.event).concat(e.payload.path?"/".concat(e.payload.path):"");"data"===e.payload.event?i.subscriptions.pEmit(r,e.payload.path,e.payload.update):i.subscriptions.emit(r,e.payload.update)}else i.subscriptions.emit(e.payload.event,e.payload.update);else e.payload&&delete e.payload.message,i.tasks.emit(e.header.id,e.payload),"/topic/subscribe"!==e.header.task&&i.buffer.remove(e.header.id)};case 30:case"end":return t.stop()}}),t,this,[[0,21]])})),r=function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){H(i,n,o,a,u,"next",t)}function u(t){H(i,n,o,a,u,"throw",t)}a(void 0)}))},function(t){return r.apply(this,arguments)})},{key:"reconnect",value:function(t){var e=this;"DISPOSED"!==this.status&&(this.recon=setTimeout((function(){e.setStatus("CONNECTING"),e.init(t)}),5e3))}},{key:"setStatus",value:function(t){"DISPOSED"!==this.status&&(this.status=t)}},{key:"dispose",value:function(){"CONNECTED"===this.status&&this.ws.close(),this.setStatus("DISPOSED"),clearTimeout(this.recon)}},{key:"disconnect",value:function(){"CONNECTED"===this.status&&this.ws.close(),this.setStatus("DISCONNECTED"),clearTimeout(this.recon)}},{key:"onConnection",value:function(t){var e=this;return this.cConnection=t,{clear:function(){e.cConnection=void 0}}}},{key:"handle",value:function(){var t=this;this.buffer.forEach((function(e){t.ws.send(JSON.stringify(e))}))}},{key:"flush",value:function(){var t=this;this.buffer.forEach((function(e){t.tasks.emit(e.header.id,void 0,{code:t.status}),t.buffer.remove(e.header.id)}))}},{key:"send",value:function(t,e){var r=this;return new Promise((function(n,o){if("SIGNATURE-INVALID"!==r.status&&"DISPOSED"!==r.status){var i=(0,P.cuid)(),a={header:{id:i,task:t},payload:e};r.tasks.once(i,(function(t,e){if(e)return o(e);n(t)})),"CONNECTED"===r.status?r.ws.send(JSON.stringify(a)):r.buffer.push(i,a)}else o({code:r.status})}))}},{key:"subscribe",value:function(t,e,r){var n=this;if(this.topics.device.includes(t)||this.topics.user.includes(t)){if(!this.topics.device.includes(t)||e.deviceID)return new Promise((function(o,i){if("SIGNATURE-INVALID"!==n.status&&"DISPOSED"!==n.status){var a=(0,P.cuid)(),u={header:{id:a,task:"/topic/subscribe"},payload:e},c=t;n.topics.device.includes(t)&&(c="".concat(e.deviceID,"/").concat(t).concat(e.path?"/".concat(e.path):""));var s=function(){return n.subscriptions.removeListener(c,r),n.subscriptions.listenerCount(c)>0?new Promise((function(t,e){return t({code:"TOPIC-UNSUBSCRIBED"})})):(n.buffer.remove(a),n.send("/topic/unsubscribe",e))};n.subscriptions.listenerCount(c)>0?(n.subscriptions.on(c,r),o({code:"TOPIC-SUBSCRIBED",clear:s})):(n.tasks.once(a,(function(t,e){if(e)return i(e);n.subscriptions.on(c,r),o(D(D({},t),{},{clear:s}))})),n.buffer.push(a,u),"CONNECTED"===n.status&&n.ws.send(JSON.stringify(u)))}else i({code:n.status})}));r({code:"DATA-INVALID"})}else r({code:"TOPIC-INVALID"})}}]),t}();const z=q;function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function W(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Q(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?W(Object(r),!0).forEach((function(e){$(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function $(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==Z(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==Z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Z(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var tt={url:"https://api.grandeur.tech",node:"wss://api.grandeur.tech"},et={};function rt(t,e){var r=Q(Q({},tt),{},{apiKey:t,secretKey:e}),n=new k(r),o=new z(r),i={post:n,duplex:o};o.init(new u(i));var a={};return Object.keys(et).map((function(t){return a[t]=function(){return new et[t](i)}})),Q({isConnected:function(){return"CONNECTED"===i.duplex.status},onConnection:function(t){return i.duplex.onConnection(t)},on:function(t){return i.duplex.onConnection(t)},dispose:function(){i.duplex.dispose(),i.post.dispose()},auth:function(){return new u(i)},devices:function(){return new v(i)},datastore:function(){return new E(i)}},a)}function nt(t){et=t}})(),n})()));